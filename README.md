# Amatsukaze

Automated MPEG2-TS Transcoder

## [ダウンロードはこちら](https://github.com/nekopanda/Amatsukaze/releases)

## これは何？

TSファイルをエンコしてmp4やmkvにするソフトです。

### 対応入力フォーマット

- コンテナ: MPEG2-TS 188バイトパケット
- 映像: MPEG2, H264
- 音声: MPEG2-AAC

これだけです。

### 対応エンコーダ

x264, x265, QSVEnc, NVEnc

### 実装されている機能

- 各出力mp4(mkv)が単一フォーマットになるように必要に応じて分割
- タイムスタンプを元にAAC音声を無劣化で再構築
- デュアルモノAACを２つのモノラルAACに無劣化分離
- 字幕をSRTやASSに変換
- ニコニコ実況コメントをASS字幕として追加（NicoConvAssが必要）
- 独自Avisynthソースクリップによる安定したチャプター・CM解析
- CMと本編の分離出力
- CMに本編とは別のビットレートを適用（一部エンコーダで制限あり）
- ロゴあり区間を自動認識してロゴファイル生成
- TSファイルからチャンネルや日時を取得してロゴを自動選択
- チャンネルやジャンルからプロファイルを自動選択
- SCRenameによるリネームやジャンルごとにフォルダ分け
- 複数映像チャンネルが入ってるTSファイルは全チャンネル認識してエンコード
- AviSynthスクリプトによるフィルタ処理
- マルチパステレシネ判定によるVFR化
- 高ビットフィルタ処理およびエンコード
- 複数エンコーダの並列実行
- EDCBからの録画後自動エンコード

### 対応環境

Windows 7以降 (64bit)
（Windows 10でしかテストしてないから他で動くか分からん）

### インストール方法

配布zipを解凍

### アンインストール方法

フォルダごと削除

## セットアップ＆エンコード手順

初回起動からエンコードまでの手順を説明します。

### 1. "Amatsukaze.vbs"を起動

<img src="https://i.imgur.com/SFTasoX.png" width="206">

### 2. 「基本設定」タブで一時フォルダを設定

<img src="https://i.imgur.com/EPOVPUy.png" width="387">

設定したら「適用」ボタンを忘れずに。

※一時フォルダは中間データが吐かれるフォルダです。SSDなどのなるべく速いディスクのフォルダを設定してください。

他の設定も必要なら設定してください。

### 3. 「キュー」タブにフォルダorファイルをドラッグ&ドロップ

<img src="https://i.imgur.com/wfjuE7o.png" width="729">

これで通常はエンコードが始まりますが、最初はロゴファイルがないので、エンコードが始まりません。以下の手順で、ロゴを生成します。

### 4. ロゴを生成

4-1. 「ロゴ生成」を起動

キューのペンディング状態となってしまったファイルを右クリック→ロゴ生成

<img src="https://i.imgur.com/iR79QvA.png" width="429">

※ワンセグは対応していないので、常に失敗します。

4-2. ロゴ位置を選択

ロゴを囲むようにマウスドラッグで選択（必要に応じて下部のタイムバーを操作）

<img src="https://i.imgur.com/1Pnbhnp.png" width="149">

4-3. ロゴスキャン

「ロゴスキャン開始」をポチって、待つ

<img src="https://i.imgur.com/6IrmuvF.png" width="151">

4-4. 結果を確認して「採用」or「キャンセル」

<img src="https://i.imgur.com/GFfZSba.png" width="285">

「採用」するとロゴが追加されてエンコードが始まります。

### 5. DRCS外字マッピングを設定

5-1. DRCS外字マッピングを追加

字幕のあるTSファイルだと、DRCS外字マッピングがないというエラーが出ることがあります。
その場合はDRCS外字パネルにマッピングのない文字の画像が出てくるので、マッピングする文字を入力して「マッピング追加」してください。

<img src="https://i.imgur.com/vt6wVfU.png" width="238">←マッピング設定例

「マッピングのない文字」を見つけたら、この操作を行ってください。

5-2. リトライ

失敗した項目は右クリック→リトライでリトライできます。

<img src="https://i.imgur.com/JO1UxAM.png" width="490">

処理が開始されると、フォルダにencoded,failed,succeededという3つのフォルダが作られ、encodedにエンコード済みmp4ファイル、succeededに成功したTSファイル、failedに失敗したTSファイルが入れられます。

### QSVEnc,NVEncのパス設定

QSVEnc,NVEncを使いたい場合は、別途入手してパスを設定してください。

<img src="https://i.imgur.com/aEDxg7r.png" width="463">←NVEncのパス設定

## AmatsukazeCLI

実際のエンコードはAmatsukazeCLI.exeがバックエンドで動いています。
コマンドラインやバッチファイルから AmatsukazeCLI.exe を直接使うこともできます。
オプションや使い方は、引数なしでコマンドを打つと表示されるヘルプを見てください。

## 設定や動作について

下に行くほど、あまり重要じゃない項目になっています。

### プロファイル

ver0.4.0.0よりエンコード設定はプロファイルに保存されます。
プロファイルは`profile`フォルダに保存されます。
他のAmatsukazeで保存したプロファイルを`profile`フォルダに入れてやればプロファイルが追加されて選べるようになります。

### [エンコード設定例](https://github.com/nekopanda/Amatsukaze/wiki/%E3%82%A8%E3%83%B3%E3%82%B3%E3%83%BC%E3%83%89%E8%A8%AD%E5%AE%9A%E4%BE%8B)

### チャプター・CM解析

チャプター・CM解析が実装されています。（中身はjoin_logo_scpです）
独自形式のロゴファイルが必要なので、上で説明した手順でロゴを採取してください。

採取したロゴは"logo"フォルダに入れられます。
以後、同じチャンネルのTSファイルはこのロゴファイルが使われます。

TSファイルによっては、うまくロゴが採取できないことがあります。
（ロゴ周辺の背景が単一色になっているフレームが必要です。）
失敗する場合はアニメとかで試してください。

途中で映像フォーマットが変わるようなTSファイルは
「ロゴ生成」だとうまくいかないことがあります。
その場合は、「ロゴ生成（TS解析あり）」を選択してください。
起動にちょっと時間がかかりますが、コチラのほうが確実です。

あと、ロゴ生成ウィンドウはいくつでも起動できるので、
待つのが嫌なら、どうぞいくつでも同時に走らせてください。
（ただし、ちょっとHDDがやばいかもｗ）

### チャンネルごとの設定

デフォルトだと、該当ロゴファイルがないTSファイルはエンコードが始まりません。
ロゴがないチャンネル（AT-Xなど）、もしくはロゴを使う必要がないチャンネルは
「チャンネルごとの設定」タブで、当該サービス（＝チャンネル）を選択して、
右のロゴリストを右クリック→「ロゴなし」を追加で
サービス（＝チャンネル）にロゴなし設定を追加してください。

<img src="https://i.imgur.com/4SPX6KV.png" width="490">

チャンネルごとのjoin_logo_scpコマンドフィイルもこのタブで設定できます。

また、ロゴに期間を設定することもできます。「ロゴなし」も期間を設定できます。
期間はTSファイルに時刻情報がある場合のみ有効です。

ロゴはいくつでも追加できます。
同じチャンネルのロゴが複数ある場合は、マッチするロゴを自動で探します。
ロゴが変わってたら採取し直してロゴを追加してください。
一度「採用」したロゴを消したい場合は、"logo"フォルダから当該ファイルを消してください。

チャンネル名、時刻などの情報は、TSファイルから取得するようになっています。
TSSplitterなどの処理により、TSファイルからこれらの情報を取り除いてしまった場合、
チャンネル名が取得できなかったり、期間設定が反映されなかったりするので、
少し使いにくくなります。（チャンネル名が「不明」や「情報なし」になります）

これらの機能は、放送ソースを前提にしたものです。TSファイルが放送ソースでない場合は
「チャプター・CM解析を無効」にすれば一応使えると思います。

### 字幕

ARIB字幕では、文字セットに定義されていない文字を、ビットマップ画像で送ってくることがあります。
これをDRCS外字と言います。画像をSRTやASSに埋め込むのは難しいため、Amatsukzeは通常の文字に変換します。
画像を認識できるようにはなっていないので、この変換はユーザが設定する必要があります。
「DRCS外字」パネルで設定してください。

ASS字幕はMPC-BEでレイアウトが正しく表示されることを確認しています。
他のプレーヤーだとレイアウトが正しく表示されないことが多いです。
これに関してはレイアウトの互換性が低すぎてどうしようもないです・・・。
あと、サロゲートペアが認識されません。

SRT字幕はレイアウト情報はなく、文字だけです。ルビなどの小さい文字も省略されています。
こちらはサロゲートペアも表示されるようです。

MKVで出力すればSRTとASS両方がMKVファイルに組み込まれます。
MP4はASSに対応していないためSRTのみが組み込まれ、ASSは別ファイルとして出力されます。

### EDCBから自動エンコード

「その他」→「EDCB用録画後実行バッチ」で、EDCBで録画後、Amatsukzeで自動エンコードするためのバッチファイルが生成できます。

必要な設定をして、「バッチファイル作成」から、バッチファイルを生成し、EDCBの録画後実行バッチのところに生成したバッチファイルへのパスを設定してください。

エンコード自体はAmatsukazeサーバで実行されます。生成したバッチファイルは、Amatsukazeサーバにタスクを投げるのが仕事です。Amatsukazeサーバが起動していない場合は、バッチファイルから起動を試みます。あらかじめ起動しておけば、起動してるAmatsukazeサーバにタスクを投げます。エンコード状況の確認やリトライなどの操作は、Amatsukazeクライアント(AmatsukazeClient.vbsで起動)から接続して行ってください。Amatsukaze.vbsから起動するのはスタンドアロンバージョンなので、エンコード状況の確認はできません。

EDCBがサービスで動いてて、EpgTimerもAmatsukazeサーバも立ち上げていない場合、AmatsukazeServerCLIがサービスで動いてるEDCBから起動されます。結果、Amatsukazeサーバがシステムアカウントで動作するので、環境によっては、AviSynthプラグインがエラーを吐くことがあるようです。システムアカウントで動いてるAmatsukazeサーバでエラーが出る場合は、手動でAmatsukazeServer.vbsからAmatsukazeサーバを起動しておくようにしてください。なお、システムアカウントで起動しているAmatsukazeサーバは、Amatsukazeクライアントから「その他」→「Amatsukazeサーバ操作」で終了できます。Amatsukazeサーバは多重起動できないようになっているので、起動しないと思ったら、Amatsukazeクライアントで接続してみてください。

録画PCとエンコードPCを別にしたい場合は、[録画後リモートエンコード](https://github.com/nekopanda/Amatsukaze/wiki/%E9%8C%B2%E7%94%BB%E5%BE%8C%E3%83%AA%E3%83%A2%E3%83%BC%E3%83%88%E3%82%A8%E3%83%B3%E3%82%B3%E3%83%BC%E3%83%89)を参照してください。

### ニコニコ実況

[NicoConvAss](http://vb45wb5b.seesaa.net/)を使って[ニコニコ実況](http://jk.nicovideo.jp/)コメントの過去ログをASS字幕として追加できます。

#### 設定方法

1. [NicoConvAss](http://vb45wb5b.seesaa.net/)を入手

2. NicoConvAss.exeへのパスを設定

<img src="https://i.imgur.com/uL4TJm9.png" width="405">

3. ニコニコ実況コメントを有効化

<img src="https://i.imgur.com/ZFyOn5l.png" width="445">

「NicoJK18サーバからコメントを取得する」場合は、これだけでOKです。NicoJK18サーバを使わない場合は、[JKCommentGetter](https://github.com/ACUVE/JKCommentGetter)のセットアップが必要になります。

NicoConvAssのパラメータを設定したい場合は、NicoConvAss.exeを起動して設定してください。

### メイン/ポストフィルタ

AviSynthによるフィルタ処理です。インタレ解除やノイズ除去などの処理がデフォルトで利用できるようになっています。

内部ロゴ消しフィルタ→メインフィルタ→ポストフィルタの順にフィルタ処理されます。

#### メインフィルタ

メインフィルタはインタレ解除です。主に以下の5種類のインタレ解除が利用可能です。

- D3DVPによる60p化
- KFMによる24p化
- KFMによる60p化
- KFMによるVFR化
- QTGMCによる60p化

同梱フィルタはGPUで処理されること前提で作られています。CPU版は最適化していないので、かなり遅く、実用的ではありません。CUDA版はNVIDIA GPUが必須です。Compute Capability 3.5以上と、比較的新しいそれなりのGPUが必要です。

#### D3DVP

D3DVPは、GPUのインタレ解除機能を使ったインタレ解除です。
PCで再生するときと同等の品質でインタレ解除します。
Windows 8以降のみ対応しています。**Windows 7では使えません。**

GPU指定なしの場合は、プライマリディスプレイに接続したGPUでインタレ解除します。
インタレ解除に使用するGPUを指定したい場合は、"Intel","NVIDIA","Radeon"を用意したので、
それを試してみてください。デバイス名の名前一致で探してくるので、
PCが認識したGPUのデバイス名が微妙に違ったりすると見つからなくてエラーになるかもしれません。
あと、当然ですが、PCにないGPUを指定したらエラーになります。

#### KFM

KFMは、映像のフレームレートを判別して、24p,30p,60p部分にそれぞれ別処理を施すフィルタです。
24pは逆テレシネ、30pはソースをそのまま、60pはQTGMCによるインタレ解除を施します。
出力は24p,60p,VFRの3つから選べます。特に問題がなければインタレ解除は**KFMによるVFR推奨**です。

#### QTGMC

QTGMCは、ソフトウェア処理によるbobベースのインタレ解除フィルタです。
計算量が多く重いフィルタですが、その分、綺麗にインタレ解除できます。
ただし、24pや30pの映像に適用すると、本来は存在しない中間フレームが生成されるなどのデメリットがあります。

処理時間に関しては、CUDA版を使えばかなり速くなります(GTX1060でフルHDが110fpsくらい）。

#### UCF,NR

UCF,NRは共にノイズリダクションです。

UCFは[DecombUCF](http://tyottoenc.blog.fc2.com/blog-entry-9.html)のアルゴリズムを使って、フレーム・フィールド置換します。

NRは2項分布マージ版SMDegrainでノイズリダクションします。

#### ポストフィルタ

ポストフィルタは高ビット処理のフィルタとなっています。以下の機能の組み合わせが利用可能です。

- 時間軸平均化（独自）
- デバンド
- エッジ強調（アニメ用）

エッジ強調はアニメ専用になっているので、アニメ以外には適用しないほうが良いと思います。

ポストフィルタは14bitで処理して10bitで出力します。
10bitでエンコードする想定で作っているので、8bitでエンコすると
ソースよりもバンディングはひどくなるかもしれません。

こちらも、CPU版は最適化していないので、かなり遅く、実用的ではありません。

### 独自AviSynthフィルタを使う

同梱スクリプトとは違うフィルタ処理をしたい場合は
スクリプトを"avs"フォルダに入れれば選択できるようになります。
ただし、メインフィルタは"メイン_"、ポストフィルタは"ポスト_"というプリフィックスで
パターンマッチしてるので、そういう名前にしてください。

同梱スクリプトを見れば分かりますが、入力は AMT_SOURCE という変数で渡されます。
メインフィルタの入力は、ソースがインターレースの場合は常にTFFです。
AviSynthには、クリップがインターレースかプログレッシブかを識別できる
ような機能はないので、便宜的にTFFをインターレース、BFFをプログレッシブと解釈しています。
インタレ解除するフィルタはAssumeBFF()でBFFで出力してください。

解像度を変更すると、出力のサンプルアスペクト比(SAR)は1:1と解釈されます。
解像度を変更しなければ、入力のサンプルアスペクト比はそのまま保持されます。
AviSynthのクリップにはサンプルアスペクト比を保持する機能がないので、
入力クリップのアスペクト比を取得する機能はありません。
もし必要なら解像度で条件分けとかしてください。

フィルタで処理されるのは映像だけです。音声は使われません。

音ズレを防ぐため、フィルタ出力の映像の時間が入力と一致しない場合はエラーとします。
カット処理や可変フレームレートには対応しません。

また、デフォルトだとシステムにインストールされているAviSynthとの干渉を防ぐため、
デフォルトのプラグインオートローディングは無効化されていて、
"exe_files/plugins64"のプラグインしか使えないようになっています。
「システムにインストールされているAviSynthプラグインを有効にする」を
チェックすると、デフォルトのプラグインオートローディングが有効になります。

### 同梱フィルタの詳細

同梱フィルタのCUDA版は、ほぼすべての処理をCUDAで行うため、高速です。

#### メインフィルタ

D3DVPによるインタレ解除フィルタは、D3DVPをそのまま呼び出しているだけです。

D3DVP以外のメインフィルタは、KFMやQTGMCによるインタレ解除を呼び出す関数 `KFMDeint()` を呼び出しています。
KFMDeintによるインタレ解除は以下のように動作します。

KFMDeintのQTGMCインタレ解除は、Preset="Faster"（SDの場合は"Slower"）で
呼び出します。CUDA版はKTGMCを呼び出します。

NNEDI3（Bob化）ベースのQTGMCなので、そのままだと細かい文字等が潰れます。
KStaticAnalyze+KStaticMergeで止まっている細かい文字等をソースから補間しています。

KFMDeintに実装されているDecombUCFは、コア部分以外は[オリジナル](http://tyottoenc.blog.fc2.com/blog-entry-9.html)と
異なった処理となっています。オリジナルは24pにしか適用できませんが、60pにも適用できるように改良されています。
24pで片フィールドが汚い判定された場合、オリジナルは24pからbobフレームを生成しますが、
KFMDeintでは、30fpsソース上で、きれいなフィールドが2フィールド以上ある場合は、DoubleWeaveから取得するようになっています。
また、オリジナルではbobフレームはTDeintで生成していますが、KFMDeintでは除外フィールド指定KTGMCで生成するようになっています。
なお、除外フィールド指定はKTGMCのみの機能で、QTGMCには実装されていません。なので、CPU版はオリジナルのままTDeintで生成します。

#### ポストフィルタ

ポストフィルタは、デバンドとエッジ強調を行うフィルタです。
最初に14bit化して、14bitで処理します。

まず、KTemporalNRで、時間軸方向のディザっぽい成分を安定化させてから、
KDebandで、デバンドします。KDebandはAviUtlのバンディング低減MTフィルタを
移植したものです。

次に、KEdgeLevelでエッジ強調します。KEdgeLevelは
AviUtlのエッジレベル調整フィルタを移植して、改造したものです。
オリジナルの処理に比べて以下の部分を改善しています。
- 文字とかのすでに十分シャープなエッジに適用すると、アンチエイリアスが失われてギザギザになってしまうのを回避するため、上限の閾値を設けて、十分シャープなエッジは除外
- 演出でボケている部分に適用しても、シャープになってしまうことがあるので、下限の閾値を設けて、ボケすぎてる部分は除外
- 適用部分が「荒くなる」のを防ぐため、RgToolsのRepair相当の処理で適用

最後に14bit→10bit変換して出力します。10bitでエンコードすれば、
デバンドが保たれたままエンコードできると思います。

### ハッシュチェック

入力TSファイルがネットワーク上にある場合、デフォルトでハッシュチェックが有効になっています。
これは、エンコードする時のネットワーク転送でデータ化けが発生していないかをチェックするAmatsukazeGUIの機能です。
（AmatsukazeCUIにこの機能はありません。）

この機能を使うには、事前にBatchHashChecker.exeでハッシュ値ファイルを生成しておく必要があります。
必要ない場合は、設定でハッシュチェックを無効にしてください。

#### BatchHashChecker

BatchHashChecker.exeは、ファイルがデータ化けしてないか、チェックするためのユーティリティです。
主に、ネットワーク転送でのビット化けや、HDD読み取りエラーでのデータ化けなどを検出するのが目的です。

例えば、D:\MyFolderにあるファイルをチェック対象にしたい場合は、以下のコマンドで、ハッシュ値ファイルを作成しておきます。
```
BatchHashChecker.exe m D:\MyFolder
```
このコマンドはフォルダ中の全てのファイルのハッシュ値を計算し、D:\MyFolder.hash に保存します。

チェックしたい時は、以下のコマンドを実行します。
```
BatchHashChecker.exe c D:\MyFolder
```
これで、ハッシュ値ファイルを作成した時点から、データが変化していないかをチェックできます。

ハッシュ値ファイルには、ファイルの相対パスが保存されているので、MyFolderを別の所に移動しても、
MyFolder.hashも同じところに移動すれば、チェックできます。

ハッシュ値ファイル自体も、ハッシュ値によるデータ化け検出ができるようになっています。
ハッシュ値ファイルの最後にハッシュ値ファイル自体のハッシュ値が記録されています。

ハッシュ値ファイルはテキストファイルなので、編集可能です。
編集するとハッシュ値が合わなくなるので、以下のコマンドでハッシュ値ファイル自体のハッシュ値を更新できます。
（D:\MyFolder.hashのハッシュ値を更新する場合）
```
BatchHashChecker.exe hu D:\MyFolder
```

#### Amatsukazeのハッシュチェック機能

ハッシュ値ファイルは、指定された入力TSファイルのあるフォルダの「フォルダ名.hash」ファイルを見に行きます。
このファイルがないとエラーになります。

ハッシュチェックが有効な場合、AmatsukazeGUIが出力mp4(or mkv)ファイルのハッシュ値も計算し、
出力フォルダの_mp4.hashファイルに書き込みます。

本来なら、ハッシュ値ファイルにファイルを追加する度に、
ハッシュ値ファイル自体のハッシュ値を再計算しなければならないのですが、
\_mp4.hashファイルはこれを省略しています。
そのため、このファイルにはハッシュ値がありません。
そのまま、出力mp4(or mkv)ファイルのハッシュチェックに使おうとするとエラーになります。
\_mp4.hashファイルが完成したら、
上で説明した`hu`コマンドで、\_mp4.hashファイルのハッシュ値を更新すれば、
BatchHashChecker.exeで出力mp4(or mkv)ファイルのハッシュチェックができるようになります。

### 制限、未実装項目

- VFRな入力（ワンセグなど）には対応していません
（VFR出力には対応しています。）
- 「通常」出力でQSVEnc,NVEncを使用した場合、CMビットレート倍率は適用されません
（x264,x265はzoneオプションで適用します）
- HEVCはインタレ保持に対応していないので、
インタレ解除しないでHEVCを使おうとするとエラーになります。
- QSVEncやNVEncの古いバージョンは高ビット入力に不具合があるので、注意してください。

## ライセンス

GPLのライブラリを組み込んでいるので、全体にGPLが適用されています。私の書いたコードはMITライセンスで提供します。
各プロジェクトと利用可能なライセンスは以下の通り。
- Amatsukaze: 一部GPLやその他のライセンスのコードを使っています。各ソースコードファイルにライセンスが書かれているのでそれを見てください。
- AmatsukazeCLI: MITライセンス
- AmatsukazeGUI: MITライセンス
- AmatsukazeUnitTest: MITライセンス
- BatchHashChecker: MITライセンス
- FileCutter: MITライセンス
- libfaad2: GPL

## 同梱&依存ライブラリ
- [FFmpeg](https://github.com/nekopanda/FFmpeg)(MPEG2フィールドピクチャのバグ修正版です)
- [FAAD2](http://www.audiocoding.com/faad2.html)
- [L-SMASH](https://github.com/l-smash/l-smash)
- [x264](https://www.videolan.org/developers/x264.html)
- [x265](http://x265.org/)（~~本家版はzonesを多く指定すると落ちるバグがあるので改造しています~~修正されたので今は本家版を入れてます）
- [Ut Video Codec Suite](http://umezawa.dyndns.info/wordpress/)
- [AviSynthPlus CUDA](https://github.com/nekopanda/AviSynthPlus)
- [join_logo_scp ver 3.06](https://mevius.5ch.net/test/read.cgi/avi/1484985868/794)
- [chapter_exe 改造版](https://github.com/nekopanda/chapter_exe)（VFWに依存しないでAvisynthスクリプトを読めるように改造しています）
- [Livet](http://ugaya40.hateblo.jp/entry/Livet)
- [MP4Box](https://gpac.wp.imt.fr/mp4box/)
- [Caption.dll](https://github.com/nekopanda/TVCaptionMod2)（使いやすいように少し改造しています）
- [mkvmerge](https://github.com/mbunkus/mkvtoolnix)
- [OpenSSL](https://www.openssl.org/)
- VC14ランタイム

同梱AviSynthプラグイン

- [LSMASH Works](https://github.com/VFR-maniac/L-SMASH-Works)
- [QTGMC](http://avisynth.nl/index.php/QTGMC)
- [RgTools](https://github.com/pinterf/RgTools)
- [NNEDI3](https://github.com/jpsdr/NNEDI3)
- [mvtools](https://github.com/pinterf/mvtools)
- [masktools](https://github.com/pinterf/masktools)
- [AvsCUDA,KTGMC,KNNEDI3,KFM](https://github.com/nekopanda/AviSynthCUDAFilters)
- [SMDegrain](http://avisynth.nl/index.php/SMDegrain)
- [D3DVP](https://github.com/nekopanda/D3DVP)

Amatsukazeと同梱&依存ライブラリはすべて64bitに統一されています。

## ビルド方法

FFmpeg（ライブラリ）が必要です。Windowsビルドのdev版を落として、
libの中身をプロジェクトのlib/x64(or x86)フォルダへコピーします。

Ut Video Codec Suite（ライブラリ）が必要です。ソースを落として、
ビルドしてください。必要なのはutv_core.libだけです。これを
lib/x64(or x86)へコピーしてください。ビルドにはcygwinが必要なので注意。

AvisynthPlusCUDAが必要です。ソースを落として、ビルドしてください。
ビルドにはCMakeが必要です。AviSynth.libをlib/x64(or x86)へコピーしてください。

単体テストプロジェクト(AmatsukazeUnitTest)は、他にgoogletestのライブラリが必要です。
サブモジュールでgoogletestは追加してあるので、git submodule updateでコードを落として、
googletest/googletest/msvc/gtest-md.slnを開いて、ビルドしてください。
できたgtest.lib/gtestd.libをlib/x64(or x86)へコピーしてください。

単体テストプロジェクト(AmatsukazeUnitTest)は、他にOpenCVも使っているので、OpenCV 3.2.0をビルドしてこれもlibをlib/x64(or x86)へコピーしてください。
